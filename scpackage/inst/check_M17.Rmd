---
title: "M17_check"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This is a 'pipeline' to check whether or not samples contain the M17 gene.

```{r}
#get files
#system("nohup bash /home/$USER/scpackage/data-raw/get_data.sh")

#assemble fastq's
#system("nohup bash /home/$USER/scpackage/inst/megahit.sh")

#get contigs in one fasta
add_accession_contigs_megahit(samples_dir = "/home/$USER/research_drive/geodescent/samples/MGYS00000974/",
                              sra_sampletype = "ERR",
                              sample_nums_from = 833272,
                              sample_nums_to = 833616,
                              outfile = "/home/$USER/research_drive/geodescent/samples/MGYS00000974/blast/contigs/all_samples4.fa")

#create blast db
makeblastdb(input = "/home/$USER/research_drive/geodescent/samples/MGYS00000974/blast/contigs/all_samples4.fa", out = "megahit_untrimmed4", dbtype = "nucl")


#run blast against db
blast(blast = "tblastn",
      blast_db = "/home/$USER/research_drive/geodescent/samples/MGYS00000974/blast/megahit_untrimmed4/megahit_untrimmed4",
      input = "/home/$USER/scpackage/inst/extdata/'M.6 M.17 IR1.txt'",
      out = "/home/$USER/research_drive/geodescent/samples/MGYS00000974/blast/test_tblastn4_2",
      format = 1)

```
